# 计算机网络
## 5 运输层

### 5.1 运输层协议概述
#### 5.1.1 进程之间的通信
1. 提供进程之间的逻辑通信
2. 差错检测
#### 5.1.2 运输层的两个主要协议
1. 数据报协议UDP
2. 传输控制协议TCP
#### 5.1.3 运输层的端口
(1)服务器端使用的端口号 
熟知端口号或系统端口号 0~1023
登记端口号1024~49151
(2)客户端使用的端口号 49152~65535

### 5.2 用户数据报协议UDP
#### 5.2.1 UDP概述
(1) UDP是无连接的
(2) UDP尽最大努力交付
(3) UDP是面向报文的
(4) UDP
#### 5.2.2 UDP的首部格式
(1) 源端口
(2) 目的端口
(3) 长度
(4) 检验和

### 5.3 传输控制协议TCP概述
#### 5.3.1 TCP 最主要的特点
(1) 面向连接的传输层协议
(2) 每一条TCP只能是点对点
(3) 可靠交付
(4) 提供全双工通信
(5) 面向字节流

#### 5.3.2  TCP的连接 套接字

### 5.4 可靠传输的实现
理想的传输条件具有以下两个特点:
(1) 传输信道不产生差错
(2) 不管发送方以多块的速度发送数据，接收方总是来得及处理收到的数据

#### 5.4.1 停止等待协议
1. 无差错情况
2. 出现差错 a.A发送完分组后必须暂时保留已经发送的副本  b.分组和分组确认都必须编号 c.超时计数器设置的重传时间应当比数据在分组传输的平均往返时间更长一点
3. 确认丢失和确认迟到
自动重传请求ARQ协议
4. 信道利用率
U=TD/(TD+RTT+TA)

#### 5.4.2 连续ARQ协议
1.发送窗口
2.累积确认

### 5.5 TCP报文段的首部格式
|源端口|目的端口    |
|序号             |
|确认号            | 
|数据偏移|保留|URG|ACK|PSH|RST|SYN|FIN|窗口|
|检验和|紧急指针|
|选项（长度可变）|填充|

选项： 长度可变，最长可达40字节。
a.最大报文段长度MMS ,默认长度536
b.窗口扩大选项 3个字节，其中一个字节表示移位值，最大为14
c.时间戳选项 10字节 时间戳字段（4个字节）+时间戳回送回答（4个字节）作用：1计算RTT,2处理TCP需要超过2^32的情况

### 5.6 TCP可靠传输的实现
#### 5.6.1 以字节为单位的窗口
TCP的发送缓存和发送窗口的关系：
发送窗口只是发送缓存的一部分，发送缓存和发送窗口的后延是重合的

注意
1.发送窗口是根据接收窗口来设置的
2.不按序到达的数据缓存，按序交付上层的应用程序
3.TCP要求接收方具有累积确认的功能

#### 5.6.2 超时重传时间的选择
